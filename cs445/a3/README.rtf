Tried to optimize the speed. Worked pretty well. 
